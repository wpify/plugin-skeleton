#!/usr/bin/env bash
# shellcheck disable=SC2046

if [ ! -f ./bin/php-scoper ]; then
	echo "=== INSTALLING PHP-SCOPER ==="

  if [ $(command -v wget) ]; then
    wget -O ./bin/php-scoper "https://github.com/humbug/php-scoper/releases/download/0.14.0/php-scoper.phar"
  elif [ $(command -v curl) ]; then
    curl -Lo ./bin/php-scoper "https://github.com/humbug/php-scoper/releases/download/0.14.0/php-scoper.phar"
  else
		echo "!!! COULD NOT INSTALL PHP-SCOPER !!!"
    exit 1
  fi

	chmod +x ./bin/php-scoper
fi

# Build scoped vendor folder
./bin/php-scoper add-prefix --output-dir=deps/prefixed --force
cd deps/prefixed && composer dump-autoload

#composer dump-autoload

#cd dist && composer dump-autoload && cd ..

#rsync -av --delete ./dist/ ~/sites/wp/wp-content/plugins/wpify-plugin/
